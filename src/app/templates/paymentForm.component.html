<div id="form-header">
    <img src="assets/img/logo-POLY-forms.png" width=180 height=80>
    <h4>DEMANDE DE PAIEMENT</h4>
    <div id="form-date">
        <mat-form-field>
            <input matInput [matDatepicker]="picker" placeholder="DATE" (click)="picker.open()">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
    </div>
</div>

<div id="entite-externe">
    <h6>ENTITÉ EXTERNE</h6>
    <mat-form-field>
        <input matInput type="text" placeholder="EMPLOYÉ (matricule)">
    </mat-form-field>
    <br>
    <mat-form-field>
        <input matInput type="text" placeholder="FOURNISSEUR (numéro)">
    </mat-form-field>

    <mat-form-field>
        <input matInput type="text" placeholder="Code adresse">
    </mat-form-field> 
</div>

<div id="beneficiaire-demandeur">
    <div id="beneficiaire">
        <h6>BÉNÉFICIAIRE</h6>
        <mat-form-field>
            <input matInput type="text" placeholder="NOM DE L'EMPLOYÉ ou DU FOURNISSEUR à payer">
        </mat-form-field>
    </div>
    <div id="demandeur">
        <h6>DEMANDEUR</h6>
        <mat-form-field>
            <input matInput type="text" placeholder="NOM DU DEMANDEUR">
        </mat-form-field>
        <mat-form-field>
            <input matInput type="text" placeholder="TÉLÉPHONE">
        </mat-form-field>
    </div>
</div>

<div id="nouveau-fournisseur">
    <h6>NOUVEAU FOURNISSEUR</h6>
    <mat-form-field>
        <input matInput type="text" placeholder="ADRESSE DE L'EMPLOYÉ ou DU FOURNISSEUR">
    </mat-form-field>

    <mat-form-field>
        <input matInput type="text" placeholder="TÉLÉPHONE">
    </mat-form-field>

    <mat-form-field>
        <input matInput type="text" placeholder="FAX">
    </mat-form-field>
    <br>
    <mat-form-field>
        <input matInput type="text" placeholder="VILLE">
    </mat-form-field>

    <mat-form-field>
        <input matInput type="text" placeholder="PROVINCE">
    </mat-form-field>

    <mat-form-field>
        <input matInput type="text" placeholder="CODE POSTAL">
    </mat-form-field>
</div>

<div id="description-facture">
    <h6>DESCRIPTION DE LA FACTURE</h6>
    <table mat-table [dataSource]="dsFactures" class="mat-elevation-z8">  
            <ng-container matColumnDef="numFacture">
              <th mat-header-cell *matHeaderCellDef> Numéro de la facture <br> (numéro de référence) </th>
              <td mat-cell *matCellDef="let facture" class="nbFacture">
                    <mat-form-field>
                        <input matInput type="text" [(ngModel)]="facture.id">
                    </mat-form-field>
              </td>
            </ng-container>
          
            <ng-container matColumnDef="descFacture">
              <th mat-header-cell *matHeaderCellDef> DESCRIPTION DE LA DÉPENSE </th>
              <td mat-cell *matCellDef="let facture" class="desc"> 
                    <mat-form-field class="descField">
                        <input matInput type="text" [(ngModel)]="facture.description">
                    </mat-form-field>
              </td>
            </ng-container>
          
            <ng-container matColumnDef="refFacture">
              <th mat-header-cell *matHeaderCellDef> Référence <a href="#ref">(1)</a> </th>
              <td mat-cell *matCellDef="let facture" class="refFact"> 
                    <mat-form-field>
                        <input matInput type="text" [(ngModel)]="facture.reference">
                    </mat-form-field>
              </td>
            </ng-container>
          
            <ng-container matColumnDef="totalFacture">
              <th mat-header-cell *matHeaderCellDef> TOTAL DE LA FACTURE <br> (en devise) </th>
              <td mat-cell *matCellDef="let facture" class="total">
                  <div class ="totalFactureDevise">
                    <mat-form-field>
                        <input matInput type="number" [(ngModel)]="facture.total">
                    </mat-form-field>

                    <mat-select placeholder="Devise">
                        <mat-option *ngFor="let c of currency" [value]="c">
                        {{ c }}
                        </mat-option>
                    </mat-select>
                  </div>
              </td>
            </ng-container>

            <ng-container matColumnDef="totalFactureCAD">
                <th mat-header-cell *matHeaderCellDef> TOTAL DE LA FACTURE <br> (en CAN) </th>
                <td mat-cell *matCellDef="let facture">
                    {{ facture.totalCAD }}
                </td>
            </ng-container>

            <ng-container matColumnDef="total">
                <td mat-footer-cell *matFooterCellDef colspan="4">
                    <strong>TOTAL: {{ total }} CAN</strong>
                </td>
            </ng-container>

            <ng-container matColumnDef="addRow" id="addRow">
                <td mat-footer-cell *matFooterCellDef>
                    <button mat-mini-fab color="primary"
                    (click)="addDescriptionRow()">+</button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            <tr mat-footer-row *matFooterRowDef="['total','addRow']"></tr>
        </table>
</div>

<div id="ventilation-budgetaire">
    <h6>VENTILATION BUDGÉTAIRE</h6>
    <table mat-table [dataSource]="dsVentilation" class="mat-elevation-z8">  
        <ng-container matColumnDef="ubr">
            <th mat-header-cell *matHeaderCellDef> UBR </th>
            <td mat-cell *matCellDef="let ventilation">
                <mat-form-field>
                    <input matInput type="text" [(ngModel)]="ventilation.ubr">
                </mat-form-field>
            </td>
        </ng-container>
        
        <ng-container matColumnDef="compte">
            <th mat-header-cell *matHeaderCellDef> COMPTE </th>
            <td mat-cell *matCellDef="let ventilation"> 
                <mat-form-field class="">
                    <input matInput type="text" [(ngModel)]="ventilation.compte">
                </mat-form-field>
            </td>
        </ng-container>
        
        <ng-container matColumnDef="unite">
            <th mat-header-cell *matHeaderCellDef> UNITÉ ADMINISTRATIVE </th>
            <td mat-cell *matCellDef="let ventilation"> 
                <mat-form-field>
                    <input matInput type="text" [(ngModel)]="ventilation.unite">
                </mat-form-field>
            </td>
        </ng-container>
        
        <ng-container matColumnDef="code">
            <th mat-header-cell *matHeaderCellDef> Code de taxes </th>
            <td mat-cell *matCellDef="let ventilation" class="code">
                <mat-form-field>
                    <input matInput type="number" [(ngModel)]="ventilation.code">
                </mat-form-field>
            </td>
        </ng-container>

        <ng-container matColumnDef="t4a">
            <th mat-header-cell *matHeaderCellDef> T4A </th>
            <td mat-cell *matCellDef="let ventilation" class="t4a">
                <mat-form-field>
                    <input matInput type="number" [(ngModel)]="ventilation.t4a">
                </mat-form-field>
            </td>
        </ng-container>

        <ng-container matColumnDef="reference">
            <th mat-header-cell *matHeaderCellDef> RÉFÉRENCE </th>
            <td mat-cell *matCellDef="let ventilation">
                <mat-form-field>
                    <input matInput type="number" [(ngModel)]="ventilation.reference">
                </mat-form-field>
            </td>
        </ng-container>

        <ng-container matColumnDef="montant">
            <th mat-header-cell *matHeaderCellDef> MONTANT APRÈS TAXE </th>
            <td mat-cell *matCellDef="let ventilation">
                <mat-form-field>
                    <input matInput type="number" [(ngModel)]="ventilation.montant">
                </mat-form-field>
            </td>
        </ng-container>

        <ng-container matColumnDef="totalV">
            <td mat-footer-cell *matFooterCellDef colspan="6">
                <strong>TOTAL: {{ totalVentilation }} CAN</strong>
            </td>
        </ng-container>

        <ng-container matColumnDef="addVRow" id="addVRow">
            <td mat-footer-cell *matFooterCellDef>
                <button mat-mini-fab color="primary"
                (click)="addVentilationRow()">+</button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsV"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsV;"></tr>
        <tr mat-footer-row *matFooterRowDef="['totalV','addVRow']"></tr>
    </table>
</div>

<div id="signatures">
    <div id="signature-demandeur" class="signature">
        <mat-form-field>
            <input matInput type="text" placeholder="SIGNATURE DU DEMANDEUR" [(ngModel)]="nomDemandeur">
            <mat-hint *ngIf="nomDemandeur.length == 0">
            Le nom et le prénom du demandeur sont obligatoires!
            </mat-hint>
        </mat-form-field>
        
        <mat-checkbox
          class="example-margin"
          [(ngModel)]="demandeurChecked"
          [(indeterminate)]="indeterminate"
          [labelPosition]="labelPosition"
          [disabled]="disabled"
          color="primary">
          Je confirme et j'accepte la véracité des informations ci-dessus.
        </mat-checkbox>
        <br>
        <button mat-raised-button *ngIf="!signatureAdded" 
          [disabled]="nomDemandeur.length == 0 || !demandeurChecked" 
          (click)="addSignature()">SIGNER</button>

        <button mat-raised-button *ngIf="signatureAdded" 
          (click)="removeSignature()">ANNULER</button>
    </div>
    <div id="signature-ubr" class="signature">
        <mat-form-field>
            <input matInput type="text" placeholder="SIGNATURE(S) DU OU DES RESPONSABLE(S) DE L'UBR">
            <mat-hint *ngIf="nomDemandeur.length == 0">
            Le(s) nom(s) et le(s) prénom(s) du ou des responsable(s) sont obligatoires!
            </mat-hint>
        </mat-form-field>
        
        <mat-checkbox
            class="example-margin"
            [(ngModel)]="ubrChecked"
            [(indeterminate)]="indeterminate"
            [labelPosition]="labelPosition"
            [disabled]="disabled"
            color="primary">
            Je confirme et j'accepte la véracité des informations ci-dessus.
        </mat-checkbox>
        <br>
        <button mat-raised-button disabled>SIGNER</button>
    </div>
    <div id="signature-sup" class="signature">
        <mat-form-field>
            <input matInput type="text" placeholder="SIGNATURE DU SUPÉRIEUR IMMÉDIAT">
            <mat-hint *ngIf="nomDemandeur.length == 0">
            Le nom et le prénom du supérieur immédiat sont obligatoires!
            </mat-hint>
        </mat-form-field>
        
        <mat-checkbox
            class="example-margin"
            [(ngModel)]="supChecked"
            [(indeterminate)]="indeterminate"
            [labelPosition]="labelPosition"
            [disabled]="disabled"
            color="primary">
            Je confirme et j'accepte la véracité des informations ci-dessus.
        </mat-checkbox>
        <br>
        <button mat-raised-button disabled>SIGNER</button>
    </div>
    <div id="signature-finance" class="signature">
        <mat-form-field>
            <input matInput type="text" placeholder="SERVICE DES FINANCES">
            <mat-hint *ngIf="nomDemandeur.length == 0">
            Nom obligatoire!
            </mat-hint>
        </mat-form-field>
        
        <mat-checkbox
            class="example-margin"
            [(ngModel)]="financeChecked"
            [(indeterminate)]="indeterminate"
            [labelPosition]="labelPosition"
            [disabled]="disabled"
            color="primary">
            Je confirme et j'accepte la véracité des informations ci-dessus.
        </mat-checkbox>
        <br>
        <button mat-raised-button disabled>SIGNER</button>
    </div>
</div>
<div id="references">
    <p>
        <strong id="ref">(1)</strong> Numéroter les factures et reporter les références à la ligne de ventilation budgétaire appropriée.
        <br> 
        <strong>*</strong> Joindre les pièces justificatives
    </p>
    <div>
        <p>Réservé au service des finances</p>
        <mat-form-field>
            <input matInput type="text" placeholder="RÉFÉRENCE SAFIRH">
        </mat-form-field>
    </div>
</div>
